<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category    design
 * @package     base_mobile
 * @copyright   Copyright (c) 2013 Magento Inc. (http://www.magentocommerce.com)
 * @license     http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */
/**
 * @var Mage_Page_Block_Html_Header $this
 */
?>

<script type="text/javascript">	
        wwidth = $j(window).width();
    var tooltipMobileFirst = 'tooltip_mobile_first';
    
    $j(window).load(function() {
		$j(".megamenu.megamenu-active img, .homepage-banner img").lazyload({
			skip_invisible : true
		});
        $j("img.lazy").lazyload();
	});
    
    $j(document).ready(function() {
        
        $j(".search-menu").click(function(){
            $j(".search-container-new-mobile").show();
        });
        $j(".close_search").click(function(){
            $j(".search-container-new-mobile").hide();
        });
        $j(".link-myaccount-mobile").click(function(){
            $j(".header .links li.myaccount").toggle();
        });
        $j("img.lazy, .wrap-banner img:not(.image-slider), .warp-banner img").after('<div class="loader"><img class="loader-img" src="<?php echo Mage::getBaseUrl(); ?>skin/frontend/base/default/images/loading.gif"></div>');
        
        $j( ".product-image-zoom" ).mouseover('mousewheel',function(e) {
                e.originalEvent.wheelDelta = 100;
        });
        $j('.wrap-megamenu').click(function() {
            $j('.bg-dark-megamenu').toggle();
            $j('.megamenu').toggleClass("megamenu-active");
        });
         $j('.bg-dark-megamenu').click(function() {
            $j('.megamenu').removeClass("megamenu-active");
            $j(this).hide();
        });

        //================mobile left menu js========================

        $j('.nav-mobile-trigger span.notclick').click(function() {
            $j(this).hide();
            $j('.nav-mobile-trigger span.clicked').show();
            $j('.mobile-left-menu').css({"left":"0","right":"45px"});
            $j('body').css({"overflow":"hidden"});
            $j('.back-left').toggle();
        });
        $j('.direktori_belanja').click(function() {
            $j('.nav-mobile-trigger span.clicked').show();
            $j('.nav-mobile-trigger span.notclick').hide();
            $j('.mobile-left-menu').css({"left":"0","right":"45px"});
            $j('body').css({"overflow":"hidden"});
            $j('.back-left').toggle();
        });
        $j('.mobile-left-menu .wrap-menu-cat > ul > li p').click(function() {
            var data_left_menu_val = $j(this).attr("data-left-menu");
                $j('.mobile-left-menu .wrap-menu-cat .wrap-first-level.' + data_left_menu_val ).addClass("menu-active");
        });

        $j('.back-level-1').click(function() {
                $j('.mobile-left-menu .wrap-menu-cat .wrap-first-level.menu-active').removeClass("menu-active");
                $j('.category-level-2 li').removeClass("open-cat-3");
        });

        $j('.mobile-left-menu .wrap-menu-cat .wrap-first-level .wrap-level2 .category-level-2 li > a,.mobile-left-menu .wrap-menu-cat .wrap-first-level .wrap-level2 .category-level-2 li > .fa').click(function() {
                $j(this).parent().toggleClass("open-cat-3");
        });
        
        //================mobile left menu js========================

        $j('.nav-mobile-trigger span.clicked, .back-button').click(function() {
            $j('.back-level-1').triggerHandler("click");
            $j('.category-level-2 li').removeClass("open-cat-3");
            $j('.nav-mobile-trigger span.clicked').hide();
            $j('.nav-mobile-trigger span.notclick').show();
            $j('.mobile-left-menu').css({"left":"-100%"});
            $j('.wrapper').css({"float":"none","margin-left":"0","position":"relative"});
            $j('body').css({"overflow":"auto"});
            $j('.back-left').toggle();
        });
        
		
    });
		
</script>

<!--Mobile Menu-->
<script type="text/javascript">
    
$j(document).ready(function() {
    $j(window).scroll(function() {
        if ($j(this).scrollTop() > 100) {
            $j(".back-to-top").fadeIn();
        }
        else {
            $j(".back-to-top").fadeOut();
        }
    });
        
	$j(".nav-container ul#nav li.parent a.level-top").live('click', function() {
            if (wwidth < 768) {
                var allPanels = $j('.nav-container li.parent ul').hide();
                
                if ($j(this).hasClass('active-submenu')) {
                    var href = $j(this).attr('href');
                    window.location.href = href;
                }
                else {
                    $j(".nav-container li.parent a.level-top").removeClass("active-submenu");
                    allPanels.slideUp();
                    $j(this).parent().next().slideDown();

                    $j(this).addClass("active-submenu");
                    //$j(this).prev().removeClass("active-submenu");
                    //$j(this).next().removeClass("active-submenu");
                    $j(this).next().css({"display":"block"});
                    return false;
                }
            }	
            else {
                var href = $j(this).attr('href');
                window.location.href = href;
            }
	});
    });
</script>


<div class="header-container">
    <?php echo $this->getLayout()->createBlock('page/html')->setTemplate('page/html/back-top.phtml')->toHtml(); ?>
    
    <div class="header">
        <div class="wrap-header-top-mobile">
            <a href="#" class="nav-mobile-trigger">
                <span class="notclick fa fa-bars"></span>
                <span class="clicked fa fa-times"></span>
            </a>
            <a href="<?php echo $this->getUrl('') ?>" title="<?php echo $this->getLogoAlt() ?>" class="logo"><strong><?php echo $this->getLogoAlt() ?></strong>
                <img src="<?php echo $this->getSkinUrl(); ?>images/2016-01-15-mobile_2.png" alt="<?php echo $this->getLogoAlt() ?>" />
            </a>

            <div class="quick-access">
                <a href="#!" class="search-menu"><i class="fa fa-search"></i></a>
                <?php require_once 'app/Mage.php';


                $sessionCustomer = Mage::getSingleton("customer/session");

                if($sessionCustomer->isLoggedIn()) {?>
                    <a href="#" class="link-myaccount-mobile loggedin"><i class="fa fa-user"></i></a>
                <?php } else {?>
                    <a href="<?php echo Mage::getBaseUrl(); ?>customer/account/login/" class="link-myaccount-mobile"><?php echo $this->__('Login') ?></a>
                <?php } ?>
                
                    <?php echo $this->getChildHtml('topLinks') ?>

                <?php $_totalItem = $this->helper('checkout/cart')->getSummaryCount();  //get total items in cart ?>

                <?php if ($_totalItem == 0): ?>
                <a href="<?php echo Mage::getBaseUrl(); ?>checkout/cart" class="link-minicart" id="link-minicart"><i class="fa fa-shopping-cart"></i><span class="qty"><?php echo $this->__('0') ?></span></a>
                <?php else: ?>
                <a href="<?php echo Mage::getBaseUrl(); ?>checkout/cart" class="link-minicart" id="link-minicart"><i class="fa fa-shopping-cart"></i><span class="qty"><?php echo $this->__($_totalItem) ?></span></a>
                <?php endif; ?>

                <p class="welcome-msg"><?php echo $this->getChildHtml('welcome') ?> <?php echo $this->getAdditionalHtml() ?></p>

                <div class="clear"></div>
            </div>
            <div class="search-container-new-mobile">
                <?php echo $this->getChildHtml('topSearch'); ?>
            </div>
        </div>
        
        <?php echo $this->getChildHtml('topContainer'); ?>
        <div class="second_button_left_menu">
            <div class="title_belanja">
                <p><?php echo $this->__('BELANJA') ?> </p>
            </div>
            <div class="direktori_belanja">
                <p><i class="fa fa-th-large"></i><?php echo $this->__('DIREKTORI BELANJA') ?> </p>
            </div>
            <?php //echo $this->getLayout()->createBlock('staticarea/block')->setId('banner-corner')->toHtml();?>
        </div>
    </div>
</div>

<div class="bg-dark-megamenu"></div>
<?php 
 $customer = Mage::getSingleton('customer/session')->getCustomer();
 if(isset($customer) && !empty($customer)){
 	$email = $customer->getEmail();// for email address
 }else{
 	$email = "";
 }
?>
<script type="text/javascript">
jQuery(document).ready(function () {    
	//dataLayer.push( {'sitetype': 'd'} );
	//dataLayer.push( {'emailaddress': '<?php echo $email; ?>'} );
});
</script>
